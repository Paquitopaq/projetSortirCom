{% extends 'base.html.twig' %}

{% block title %}Annuler la sortie {{ sortie.nom }}{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/sortie-delete.css') }}">
{% endblock %}

{% block body %}
    <div class="container">
        <h1 class="page-title">Annuler une sortie</h1>

        <!-- Informations de la sortie -->
        <div class="info-card">
            <table class="info-table">
                <tbody>
                <tr>
                    <th><i class="fas fa-tag"></i> Nom de la sortie</th>
                    <td>{{ sortie.nom }}</td>
                </tr>
                <tr>
                    <th><i class="fas fa-calendar"></i> Date de début</th>
                    <td>{{ sortie.dateHeureDebut|date('d/m/Y à H:i') }}</td>
                </tr>
                <tr>
                    <th><i class="fas fa-building"></i> Site organisateur</th>
                    <td>{{ sortie.site.nom ?? 'Non défini' }}</td>
                </tr>
                <tr>
                    <th><i class="fas fa-map-marker-alt"></i> Lieu</th>
                    <td>
                        {% if sortie.lieu %}
                            {{ sortie.lieu.nom }}
                            {% if sortie.lieu.ville %}
                                - {{ sortie.lieu.ville.codePostal }} {{ sortie.lieu.ville.nom }}
                            {% endif %}
                        {% else %}
                            <em style="color: #999;">Aucun lieu associé</em>
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <th><i class="fas fa-users"></i> Participants</th>
                    <td>{{ sortie.participants|length }} / {{ sortie.nbInscriptionMax }} inscrits</td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Formulaire d'annulation -->
        <div class="form-card">
            {{ form_start(form) }}

            <div>
                <label class="form-label" for="{{ form.motifAnnulation.vars.id }}">
                    <i class="fas fa-comment"></i> Motif d'annulation *
                </label>
                {{ form_widget(form.motifAnnulation, {
                    'attr': {
                        'class': 'form-control',
                        'rows': 5,
                        'placeholder': 'Expliquez pourquoi vous devez annuler cette sortie...'
                    }
                }) }}
                {% if form.motifAnnulation.vars.errors|length > 0 %}
                    <div class="form-errors">
                        {{ form_errors(form.motifAnnulation) }}
                    </div>
                {% endif %}
            </div>

            <div class="alert-warning">
                <i class="fas fa-exclamation-triangle"></i>
                <div>
                    <strong>Attention !</strong> Cette action est irréversible.<br>
                    La sortie sera définitivement marquée comme <strong>Annulée</strong> et tous les participants seront notifiés.
                </div>
            </div>

            <button type="submit" class="btn btn-danger">
                <i class="fas fa-times-circle"></i> Confirmer l'annulation
            </button>

            {{ form_end(form) }}
        </div>

        <!-- Bouton retour -->
        <div class="actions-container">
            <a href="{{ path('sortie_detail', {'id': sortie.id}) }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Retour à la sortie
            </a>
        </div>
    </div>
{% endblock %}