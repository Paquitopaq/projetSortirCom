{% extends 'base.html.twig' %}

{% block title %}Accueil | BougeTonCrew{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/home.css') }}">
{% endblock %}

{% block body %}
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">Sortir à Niort</h1>
                <p class="hero-subtitle">Découvrez les meilleures sorties et événements près de chez vous</p>
                <div class="hero-buttons">
                    <a href="{{ path('app_sortie') }}" class="btn-primary-large">Explorer les sorties</a>
                    <a href="{{ path('sortie_create') }}" class="btn-secondary-large">Créer une sortie</a>
                </div>
            </div>
            <div class="hero-image">
                <img src="{{ asset('assets/images/niort-fond.jpg') }}" alt="Niort">
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="stats-section">
        <div class="stats-container">
            <div class="stat-item">
                <div class="stat-number">{{ sorties|length }}</div>
                <div class="stat-label">Sorties disponibles</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">500+</div>
                <div class="stat-label">Participants actifs</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">50+</div>
                <div class="stat-label">Organisateurs</div>
            </div>
        </div>
    </section>

    <!-- Sorties Section -->
    <section class="sorties-section">
        <div class="section-header">
            <h2 class="section-title">Prochaines sorties</h2>
            <a href="{{ path('app_sortie') }}" class="see-all">Voir tout →</a>
        </div>

        <div class="sorties-grid">
            {% for sortie in sorties|slice(0, 6) %}
                <div class="sortie-card">
                    <div class="sortie-image">
                        <img src="https://images.unsplash.com/photo-1533174072545-7a4b6ad7a6c3?w=400&h=300&fit=crop" alt="{{ sortie.nom }}">
                        <span class="sortie-badge">{{ sortie.etat.value }}</span>
                    </div>
                    <div class="sortie-content">
                        <h3 class="sortie-title">{{ sortie.nom }}</h3>
                        <div class="sortie-meta">
                            <div class="sortie-date">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                                {% if sortie.dateHeureDebut %}
                                    {{ sortie.dateHeureDebut|date('d/m/Y à H:i') }}
                                {% else %}
                                    Date à définir
                                {% endif %}
                            </div>
                            <div class="sortie-participants">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                0/{{ sortie.nbInscriptionMax }} places
                            </div>
                        </div>
                        <div class="sortie-footer">
                            <div class="sortie-organizer">
                                <div class="organizer-avatar">A</div>
                                <span>Admin</span>
                            </div>
                            <a href="#" class="btn-join">S'inscrire</a>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="no-sorties">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    <h3>Aucune sortie disponible</h3>
                    <p>Soyez le premier à créer une sortie !</p>
                    <a href="{{ path('sortie_create') }}" class="btn-primary-large">Créer une sortie</a>
                </div>
            {% endfor %}
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="cta-content">
            <h2 class="cta-title">Prêt à organiser votre première sortie ?</h2>
            <p class="cta-subtitle">Rejoignez notre communauté et partagez vos passions avec d'autres personnes</p>
            <a href="{{ path('sortie_create') }}" class="btn-cta">Créer ma première sortie</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>MonApp</h4>
                <p>La plateforme pour organiser et participer à des sorties près de chez vous.</p>
            </div>
            <div class="footer-section">
                <h4>Navigation</h4>
                <a href="{{ path('app_home') }}">Accueil</a>
                <a href="{{ path('app_sortie') }}">Sorties</a>
                <a href="{{ path('sortie_create') }}">Créer une sortie</a>
            </div>
            <div class="footer-section">
                <h4>Compte</h4>
                {% if app.user %}
                    <a href="{{ path('profile_index') }}">Mon profil</a>
                    <a href="{{ path('profile_edit') }}">Paramètres</a>
                {% else %}
                    <a href="{{ path('app_login') }}">Se connecter</a>
                    <a href="{{ path('app_register') }}">S'inscrire</a>
                {% endif %}
            </div>
            <div class="footer-section">
                <h4>Légal</h4>
                <a href="#">Mentions légales</a>
                <a href="#">CGU</a>
                <a href="#">Politique de confidentialité</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; {{ "now"|date("Y") }} MonApp - Tous droits réservés</p>
        </div>
    </footer>
{% endblock %}

{% block javascripts %}
    <!-- flatpickr JS + localisation FR -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/fr.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const el = document.querySelector('.datepicker');
            if (!el) {
                console.error('Flatpickr: aucun élément avec la classe .datepicker trouvé.');
                return;
            }

            flatpickr(el, {
                enableTime: true,
                dateFormat: "Y-m-d H:i",
                altInput: true,
                altFormat: "d/m/Y à H:i",
                time_24hr: true,
                locale: "fr",
            });
        });
    </script>
{% endblock %}
